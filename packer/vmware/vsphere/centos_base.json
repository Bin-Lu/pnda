{
    "builders": [
      {
        "vm_name": "{{user `vm_name_base`}}",
        "type": "vsphere-iso",
        "vcenter_server": "{{user `vsphere_host`}}",
        "username": "{{user `vsphere_user`}}",
        "password": "{{user `vsphere_password`}}",
        "insecure_connection": "true",
        "cluster": "{{user `vsphere_cluster`}}",
        "host": "{{user `esxi_host`}}",
        "datastore": "{{user `vsphere_datastore`}}",
        "guest_os_type": "centos7-64",
        "ssh_username": "{{user `username`}}",
        "ssh_password": "{{user `password`}}",
      "CPUs":             1,
      "RAM":              1024,
      "RAM_reserve_all": true,
      "disk_controller_type":  "pvscsi",
      "disk_size":        32768,
      "disk_thin_provisioned": true,
     "network": "{{user `vsphere_portgroup`}}",
     "network_card": "vmxnet3",

      "iso_paths": [
        "[{{user `vsphere_datastore`}}] isos/CentOS-7-x86_64-Minimal-1804.iso"
      ],

     "floppy_files": [
        "http/ks.cfg"
      ],
      "boot_command": "<tab> inst.text inst.ks=hd:fd0:/ks.cfg <enter><wait>"
      }
    ],
    "provisioners": [
      {
        "type": "shell",
        "scripts": [
          "scripts/open-vm-tools.sh"
        ],
        "execute_command": "{{ .Vars }} sudo -E -S bash '{{ .Path }}'"
      }
    ],
    "variables": {
      "template_name": "{{env `PACKER_VM_NAME`}}",
      "username": "root",
      "password": "{{env `ROOT_PASSWD`}}",
      "version": "{{env `PACKER_VM_VERSION`}}",
      "packer_vcenter_host": "{{env `PACKER_VCENTER_HOST`}}",
      "packer_vcenter_datacenter": "{{env `PACKER_VCENTER_DC`}}",
      "packer_vcenter_cluster": "{{env `PACKER_VCENTER_CLUSTER`}}",
      "packer_vcenter_datastore": "{{env `PACKER_VCENTER_DATASTORE`}}",
      "packer_vcenter_username": "{{env `PACKER_VCENTER_USERNAME`}}",
      "packer_vcenter_password": "{{env `PACKER_VCENTER_PASSWORD`}}"
    }
  }
